<!doctype html>
<div id="instructions_splash"
     style="
        position:fixed;
        top:50%;
        left:50%;
        height:80%;
        width:80%;
        transform:translate(-50%, -50%);
        display: flex;
        align-items:center;
        flex-direction:column;
        font-size:14px;
        z-index:103;
        font-family: 'Helvetica Neue', serif;
        text-align: left;
        color:#4B4B4B;
        background-color:#E4E4E4;
        visibility:visible;
        border-radius:8px;
        border-color:#E6E6E6;
        border-style:solid;
        padding-right:1%;
        padding-left:1%;"
>
    <span id='instructions_splash_text'> Instructions placeholder </span>
    <button onclick="document.getElementById('instructions_splash').style.display = 'none';" id='instructions_done_button' disabled>Preview Mode. Accept the HIT if you would like to participate!</button>
</div>

<body>
Task page
</body>

<head>
    <script src="sr_task.js" type="text/javascript"></script>
    <script src="../common/mturk_submission.js" type="text/javascript"></script>
    <script src="../common/canvas.js" type="text/javascript"></script>
    <script src="../common/image_loading.js" type="text/javascript"></script>
    <script src="../common/subject_action.js" type="text/javascript"></script>
    <script src="../common/math_utils.js" type="text/javascript"></script>

    <script>

        // Extract session info
        var assignmentId = mechanical_turk_util_functions.get_assignmentId_from_url(window.location);
        var in_preview_mode = mechanical_turk_util_functions.detect_previewer(window.location);

        if (in_preview_mode === false){
            console.log('hello');
            var btn = document.getElementById('instructions_done_button');
            btn.disabled = false;
            btn.innerHTML = "I understand the instructions and would like to begin the task."
        }

        // Assemble task info, possibly randomly on-load
        var blue = 'https://milresources.s3.amazonaws.com/Images/AbstractShapes/bluediamond.png';
        var orange = 'https://milresources.s3.amazonaws.com/Images/AbstractShapes/orangediamond.png';

        var image_url_sequence = [blue, blue, blue, orange];
        var label_sequence = [0, 0, 0, 1];
        var stimulus_duration_msec = 200;
        var reward_duration_msec = 100;
        var punish_duration_msec = 1000;
        var choice_duration_msec = 5000;
        var post_stimulus_delay_duration_msec = 0;

        // Run tasks
        var subtask_sequence = [
            {
                'image_url_seq':image_url_sequence,
                'label_seq':label_sequence,
                'stimulus_duration_msec':stimulus_duration_msec,
                'reward_duration_msec':reward_duration_msec,
                'punish_duration_msec':punish_duration_msec,
                'choice_duration_msec':choice_duration_msec,
                'post_stimulus_delay_duration_msec':post_stimulus_delay_duration_msec,
            },
            {
                'image_url_seq':image_url_sequence,
                'label_seq':label_sequence,
                'stimulus_duration_msec':stimulus_duration_msec,
                'reward_duration_msec':reward_duration_msec,
                'punish_duration_msec':punish_duration_msec,
                'choice_duration_msec':choice_duration_msec,
                'post_stimulus_delay_duration_msec':post_stimulus_delay_duration_msec,
            },
        ];
        (async function (){
            var session_data = await run_subtasks(subtask_sequence);
            var sandbox = false;
            await mechanical_turk_util_functions.submit_data(assignmentId, sandbox, session_data);
        }());

    </script>
    <title>DiCarlo Lab - Mechanical Turk</title>
</head>


